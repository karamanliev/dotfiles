[
  {
    "layer": "top",
    "output": "DP-3",
    "spacing": 0,
    "height": 16,
    "margin-top": 0,
    "margin-right": 0,
    "margin-bottom": 0,
    "margin-left": 0,
    "modules-left": [
      "custom/vicinae",
      "custom/separator",
      "niri/workspaces",
      "custom/separator",
      "cffi/niri-taskbar",
      // "custom/separator",
      // "custom/timer",
      "custom/separator",
      "custom/claude-usage"
    ],
    "modules-center": [
      "custom/weather",
      "custom/separator",
      "clock",
      "custom/separator",
      "custom/agenda"
    ],
    "modules-right": [
      "cpu",
      "custom/separator",
      "custom/gpu",
      // "custom/separator",
      // "temperature",
      "custom/separator",
      "memory",
      "custom/separator",
      "tray",
      "idle_inhibitor",
      "custom/sunsetr",
      "custom/gsr",
      "custom/separator",
      "niri/language",
      "custom/separator",
      "custom/voxtype",
      "pulseaudio",
      "custom/separator",
      "custom/notification"
    ],
    "custom/separator": {
      "format": "       ",
      "tooltip": false
    },
    // https://github.com/peteonrails/voxtype
    "custom/voxtype": {
      "exec": "voxtype status --follow --format json --extended",
      "return-type": "json",
      "format": "{}",
      "tooltip": true,
      "on-click": "voxtype record toggle",
      "on-click-right": "voxtype record cancel"
    },
    // get it from the forked repo at https://github.com/karamanliev/niri-taskbar
    "cffi/niri-taskbar": {
      "module_path": "/home/ico/.config/waybar/plugins/libniri_taskbar.so",
      "only_current_workspace": true,
      "icon_size": 20,
      // "show_all_outputs": true,
      "on-scroll-up": "niri msg action focus-column-left-or-last",
      "on-scroll-down": "niri msg action focus-column-right-or-first"
    },
    // uses uv tool waybar-ai-usage - `uv tool list`
    "custom/claude-usage": {
      "exec": "claude-usage --waybar --show-5h --format '{icon} {?5h_reset}{5h_pct}%   {time_icon} {5h_reset}{/5h_reset}'",
      "return-type": "json",
      "interval": 120,
      "format": "{}",
      // "format": "󰜡",
      "tooltip": true,
      "on-click": "rm -f ~/.cache/waybar-ai-usage/claude.json && pkill -RTMIN+8 waybar",
      "on-click-middle": "claude -p hi;sleep 1;pkill -RTMIN+8 waybar",
      // "on-click-middle": "kitty -e claude -p hi;sleep 5;pkill -RTMIN+8 waybar",
      "signal": 8
    },
    "custom/vicinae": {
      "format": "<span font_size='11.5pt'>{icon}</span>",
      "tooltip": false,
      "format-icons": {
        "default": "󰌧"
      },
      "on-click": "vicinae toggle",
      "on-click-right": "vicinae vicinae://extensions/vicinae/wm/switch-windows"
    },
    "custom/agenda": {
      "format": "<span font_size='large'>󰨲</span>  {0}",
      "exec": "${HOME}/.config/waybar/scripts/plann.py --max-title-length 30 --notify-min-before-events 10 --waybar-show-all-day-meeting --waybar --config-section personal",
      "on-click-middle": "${HOME}/.config/waybar/scripts/plann.py --open-meet-url --config-section personal",
      "on-click": "betterbird -calendar;niri msg action focus-workspace \"MAIL\"",
      "interval": 59,
      "return-type": "json",
      "tooltip": "true"
    },
    "custom/timer": {
      "tooltip": true,
      "return-type": "json",
      "exec": "$HOME/.config/waybar/scripts/waybar_timer.sh check",
      "on-click": "[[ $(niri msg --json windows | jq -r '.[] | select(.title == \"Set timer\") | .id') ]] && niri msg action close-window --id $(niri msg --json windows | jq -r '.[] | select(.title == \"Set timer\") | .id') || $HOME/.config/waybar/scripts/waybar_timer.sh minute_dialog",
      "on-click-right": "[[ $(niri msg --json windows | jq -r '.[] | select(.title == \"Set timer\") | .id') ]] && niri msg action close-window --id $(niri msg --json windows | jq -r '.[] | select(.title == \"Set timer\") | .id') || $HOME/.config/waybar/scripts/waybar_timer.sh datetime_dialog",
      "on-click-middle": "$HOME/.config/waybar/scripts/waybar_timer.sh stop",
      "interval": 1
    },
    "tray": {
      "icon-size": 18,
      "spacing": 10
    },
    "idle_inhibitor": {
      "format": "<span font_size='large'>{icon}</span>",
      "format-icons": {
        "activated": "",
        "deactivated": ""
      }
    },
    "custom/notification": {
      "tooltip": false,
      "format": "<span font_size='x-large'>{icon}</span><span font_size='10.5pt'>{0}</span>",
      "format-icons": {
        "notification": "󰂚",
        "none": "󰂚",
        "dnd-notification": "󰂛",
        "dnd-none": "󰂛"
      },
      "return-type": "json",
      "exec-if": "which swaync-client",
      "exec": "swaync-client -swb | jq --unbuffered --compact-output 'if .text == \"0\" then .text = \"\" else .text = \"  \" + .text end'",
      "on-click": "swaync-client -t -sw",
      "on-click-right": "swaync-client -d -sw",
      "on-click-middle": "niri msg action toggle-overview",
      "escape": true
    },
    "niri/workspaces": {
      "format": "{value}",
      "on-scroll-up": "niri msg action focus-workspace-up",
      "on-scroll-down": "niri msg action focus-workspace-down"
    },
    "clock": {
      "format": "{:%a %d %b    %H:%M}",
      "tooltip-format": "<tt>{calendar}</tt>",
      "locale": "en_GB.UTF-8",
      "on-click": "betterbird -calendar;niri msg action focus-workspace \"MAIL\"",
      "on-click-right": "xdg-open https://calendar.google.com/",
      "calendar": {
        "mode": "month",
        "mode-mon-col": 3,
        "weeks-pos": "",
        "on-scroll": 1,
        "format": {
          "months": "<span color='#d8c5fa'><b>{}</b></span>",
          "days": "<span color='#f8f8f8'><b>{}</b></span>",
          "weeks": "<span color='#99ffdd'><b>W{}</b></span>",
          "weekdays": "<span color='#c4bed1'><b>{}</b></span>",
          "today": "<span color='#BB9AF7'><b><u>{}</u></b></span>"
        }
      },
      "actions": {
        "on-click-right": "mode",
        "on-scroll-up": "tz_up",
        "on-scroll-down": "tz_down",
        "on-scroll-up": "shift_up",
        "on-scroll-down": "shift_down"
      }
    },
    "cpu": {
      "format": "CPU {usage}%",
      "interval": 2,
      "states": {
        "critical": 90
      },
      "on-click": "[[ $(niri msg --json windows | jq -r '.[] | select(.app_id == \"system_monitor_btop\") | .id') ]] && niri msg action close-window --id $(niri msg --json windows | jq -r '.[] | select(.app_id == \"system_monitor_btop\") | .id') || kitty --app-id=system_monitor_btop --single-instance -e btop"
    },
    "custom/gpu": {
      // "exec": "nvidia-smi --query-gpu=utilization.gpu,temperature.gpu --format=csv,nounits,noheader | sed 's/\\([0-9]\\+\\), \\([0-9]\\+\\)/\\1% ⋅ \\2°C/g'",
      "exec": "nvidia-smi --query-gpu=utilization.gpu,temperature.gpu --format=csv,nounits,noheader | sed 's/\\([0-9]\\+\\), \\([0-9]\\+\\)/\\1/g'",
      "format": "GPU {0}%",
      "interval": 2,
      "tooltip": true,
      "on-click": "[[ $(niri msg --json windows | jq -r '.[] | select(.app_id == \"system_monitor_btop\") | .id') ]] && niri msg action close-window --id $(niri msg --json windows | jq -r '.[] | select(.app_id == \"system_monitor_btop\") | .id') || kitty --app-id=system_monitor_btop --single-instance -e btop"
    },
    // "temperature": {
    //   "hwmon-path-abs": "/sys/devices/pci0000:00/0000:00:18.3/hwmon",
    //   "input-filename": "temp1_input",
    //   "format": "TEMP {temperatureC}°C",
    // },
    "memory": {
      "format": "MEM {percentage}%",
      "interval": 2,
      "states": {
        "critical": 80
      },
      "on-click": "[[ $(niri msg --json windows | jq -r '.[] | select(.app_id == \"system_monitor_btop\") | .id') ]] && niri msg action close-window --id $(niri msg --json windows | jq -r '.[] | select(.app_id == \"system_monitor_btop\") | .id') || kitty --app-id=system_monitor_btop --single-instance -e btop"
    },
    "niri/language": {
      "format": "<span font_size='large'>󰌌</span>  {}",
      "format-en": "EN",
      "format-bg": "BG",
      "on-click": "niri msg action switch-layout \"next\""
    },
    "pulseaudio": {
      "scroll-step": 5,
      "max-volume": 100,
      "format": "<span font_size='large'>{icon}</span> {volume}%    {format_source}",
      "format-muted": "<span font_size='large'>󰝟 </span> 0%     {format_source}",
      "format-source-muted": "<span font_size='large'>󰍭 </span> 0%",
      "format-source": "<span font_size='large'>󰍬 </span> {volume}%",
      "format-icons": {
        "default": [
          "󰕿 ",
          "󰖀 ",
          "󰕾 "
        ]
      },
      "on-click": "[[ $(pgrep -x pavucontrol) ]] && pkill -x pavucontrol || pavucontrol",
      "on-click-middle": "pactl set-sink-mute $(pactl get-default-sink) toggle",
      "on-click-right": "pactl set-source-mute $(pactl get-default-source) toggle",
      "tooltip": false
    },
    "custom/weather": {
      "format": "{}",
      "tooltip": true,
      "restart-interval": 900,
      "exec": "${HOME}/.config/waybar/scripts/weather.py waybar",
      "on-click": "xdg-open https://openweathermap.org/city/726050",
      "on-click-right": "xdg-open https://www.sinoptik.bg/varna-bulgaria-100726050/14-days",
      "return-type": "json"
    },
    "custom/sunsetr": {
      "exec": "${HOME}/.config/waybar/scripts/sunsetr.sh status",
      "return-type": "json",
      "format": "<span font_size='x-large'>{icon}</span> <span font_scale='small-caps' baseline_shift='2pt'>{text}%</span>",
      "format-icons": {
        "day": "󰖨",
        "night": "",
        "sunset": "󰖛",
        "sunrise": "󰖜",
        "static": "󰋙"
      },
      "on-click": "${HOME}/.config/waybar/scripts/sunsetr.sh toggle",
      "on-scroll-up": "${HOME}/.config/waybar/scripts/sunsetr.sh up",
      "on-scroll-down": "${HOME}/.config/waybar/scripts/sunsetr.sh down"
    },
    "custom/gsr": {
      "exec": "$HOME/.local/bin/gsr.sh status",
      "format": "<span font_size='x-large'>{icon}</span>{text}",
      "format-icons": {
        "both": "󱍷 ",
        "recording": "󰻃 ",
        "paused": " ",
        "replay": "󱘌 ",
        "inactive": "󰙧"
      },
      "return-type": "json",
      "interval": "once",
      "signal": 1,
      "on-click": "${HOME}/.config/waybar/scripts/gsr.sh DP-3",
      "on-click-right": "${HOME}/.config/waybar/scripts/gsr.sh DP-1",
      "tooltip": true
    }
  },
  {
    "layer": "top",
    "output": "DP-1",
    "spacing": 0,
    "height": 16,
    "margin-top": 0,
    "margin-right": 0,
    "margin-bottom": 0,
    "margin-left": 0,
    "modules-left": [
      "custom/vicinae",
      "custom/separator",
      "niri/workspaces",
      "custom/separator",
      "cffi/niri-taskbar"
    ],
    "modules-center": [
      "custom/weather",
      "custom/separator",
      "clock"
    ],
    "modules-right": [
      // "cpu",
      // "custom/separator",
      // "temperature",
      // "custom/separator",
      // "memory",
      // "custom/separator",
      // "tray",
      "idle_inhibitor",
      "custom/sunsetr",
      "custom/gsr",
      "custom/separator",
      "niri/language",
      "custom/separator",
      "pulseaudio",
      "custom/separator",
      "custom/notification"
    ],
    "custom/separator": {
      "format": "       ",
      "tooltip": false
    },
    "cffi/niri-taskbar": {
      "module_path": "/home/ico/.config/waybar/plugins/libniri_taskbar.so",
      "only_current_workspace": true,
      "icon_size": 20,
      // "show_all_outputs": true,
      "on-scroll-up": "niri msg action focus-column-left-or-last",
      "on-scroll-down": "niri msg action focus-column-right-or-first"
    },
    "custom/vicinae": {
      "format": "<span font_size='11.5pt'>{icon}</span>",
      "tooltip": false,
      "format-icons": {
        "default": "󰌧"
      },
      "on-click": "vicinae toggle",
      "on-click-right": "vicinae vicinae://extensions/vicinae/wm/switch-windows"
    },
    "tray": {
      "icon-size": 18,
      "spacing": 10
    },
    "idle_inhibitor": {
      "format": "<span font_size='large'>{icon}</span>",
      "format-icons": {
        "activated": "",
        "deactivated": ""
      }
    },
    "custom/notification": {
      "tooltip": false,
      "format": "<span font_size='x-large'>{icon}</span><span font_size='10.5pt'>{0}</span>",
      "format-icons": {
        "notification": "󰂚",
        "none": "󰂚",
        "dnd-notification": "󰂛",
        "dnd-none": "󰂛"
      },
      "return-type": "json",
      "exec-if": "which swaync-client",
      "exec": "swaync-client -swb | jq --unbuffered --compact-output 'if .text == \"0\" then .text = \"\" else .text = \"  \" + .text end'",
      "on-click": "swaync-client -t -sw",
      "on-click-right": "swaync-client -d -sw",
      "on-click-middle": "niri msg action toggle-overview",
      "escape": true
    },
    "niri/workspaces": {
      "format": "{value}",
      "on-scroll-up": "niri msg action focus-workspace-up",
      "on-scroll-down": "niri msg action focus-workspace-down"
    },
    "clock": {
      "format": "{:%a %d %b    %H:%M}",
      "tooltip-format": "<tt>{calendar}</tt>",
      "locale": "en_GB.UTF-8",
      "on-click": "betterbird -calendar;niri msg action focus-workspace \"MAIL\"",
      "on-click-right": "xdg-open https://calendar.google.com/",
      "calendar": {
        "mode": "month",
        "mode-mon-col": 3,
        "weeks-pos": "",
        "on-scroll": 1,
        "format": {
          "months": "<span color='#d8c5fa'><b>{}</b></span>",
          "days": "<span color='#f8f8f8'><b>{}</b></span>",
          "weeks": "<span color='#99ffdd'><b>W{}</b></span>",
          "weekdays": "<span color='#c4bed1'><b>{}</b></span>",
          "today": "<span color='#BB9AF7'><b><u>{}</u></b></span>"
        }
      },
      "actions": {
        "on-click-right": "mode",
        "on-scroll-up": "tz_up",
        "on-scroll-down": "tz_down",
        "on-scroll-up": "shift_up",
        "on-scroll-down": "shift_down"
      }
    },
    "niri/language": {
      "format": "<span font_size='large'>󰌌</span>  {}",
      "format-en": "EN",
      "format-bg": "BG",
      "on-click": "niri msg action switch-layout \"next\""
    },
    "pulseaudio": {
      "scroll-step": 5,
      "max-volume": 100,
      "format": "<span font_size='large'>{icon}</span> {volume}%    {format_source}",
      "format-muted": "<span font_size='large'>󰝟 </span> 0%     {format_source}",
      "format-source-muted": "<span font_size='large'>󰍭 </span> 0%",
      "format-source": "<span font_size='large'>󰍬 </span> {volume}%",
      "format-icons": {
        "default": [
          "󰕿 ",
          "󰖀 ",
          "󰕾 "
        ]
      },
      "on-click": "[[ $(pgrep -x pavucontrol) ]] && pkill -x pavucontrol || pavucontrol",
      "on-click-middle": "pactl set-sink-mute $(pactl get-default-sink) toggle",
      "on-click-right": "pactl set-source-mute $(pactl get-default-source) toggle",
      "tooltip": false
    },
    "custom/weather": {
      "format": "{}",
      "tooltip": true,
      "restart-interval": 900,
      "exec": "${HOME}/.config/waybar/scripts/weather.py waybar",
      "on-click": "xdg-open https://openweathermap.org/city/726050",
      "on-click-right": "xdg-open https://www.sinoptik.bg/varna-bulgaria-100726050/14-days",
      "return-type": "json"
    },
    "custom/sunsetr": {
      "exec": "${HOME}/.config/waybar/scripts/sunsetr.sh status",
      "return-type": "json",
      "format": "<span font_size='x-large'>{icon}</span> <span font_scale='small-caps' baseline_shift='2pt'>{text}%</span>",
      "format-icons": {
        "day": "󰖨",
        "night": "",
        "sunset": "󰖛",
        "sunrise": "󰖜",
        "static": "󰋙"
      },
      "on-click": "${HOME}/.config/waybar/scripts/sunsetr.sh toggle",
      "on-scroll-up": "${HOME}/.config/waybar/scripts/sunsetr.sh up",
      "on-scroll-down": "${HOME}/.config/waybar/scripts/sunsetr.sh down"
    },
    "custom/gsr": {
      "exec": "$HOME/.local/bin/gsr.sh status",
      "format": "<span font_size='x-large'>{icon}</span>{text}",
      "format-icons": {
        "both": "󱍷 ",
        "recording": "󰻃 ",
        "paused": " ",
        "replay": "󱘌 ",
        "inactive": "󰙧"
      },
      "return-type": "json",
      "interval": "once",
      "signal": 1,
      "on-click": "${HOME}/.config/waybar/scripts/gsr.sh DP-3",
      "on-click-right": "${HOME}/.config/waybar/scripts/gsr.sh DP-1",
      "tooltip": true
    }
  }
]
