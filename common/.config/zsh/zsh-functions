fg_widget() {
  fg
}

zle -N fg_widget

# Yazi shell wrapper to change dirs fast
function y() {
  local tmp="$(mktemp -t "yazi-cwd.XXXXXX")" cwd
  yazi "$@" --cwd-file="$tmp"
  if cwd="$(command cat -- "$tmp")" && [ -n "$cwd" ] && [ "$cwd" != "$PWD" ]; then
    builtin cd -- "$cwd"
  fi
  rm -f -- "$tmp"
}

# Fix for autosuggestions breaking when selecting a suggestion
# more info: https://github.com/zsh-users/zsh-autosuggestions/issues/816
menu-complete-wrap() {
  zle menu-complete
}
zle -N menu-complete-wrap

change_terminal_colorscheme() {
  zsh-sync-colors.sh
}
zle -N change_terminal_colorscheme

function cdi_widget() {
  zle -I
  cdi
  zle reset-prompt
}

zle -N cdi_widget

# Create a directory and cd into it
mkcd() { mkdir -p "$1" && cd "$1"; }

# open sesh outside tmux
function sesh-sessions() {
  {
    exec </dev/tty
    exec <&1
    local session
    session=$(sesh list -i -d | fzf --height 40% --reverse --border-label ' sesh ' --border --ansi --prompt 'âš¡  ')
    zle reset-prompt >/dev/null 2>&1 || true
    [[ -z "$session" ]] && return
    sesh connect $session
  }
}

zle -N sesh-sessions
